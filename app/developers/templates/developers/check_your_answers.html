{% from "govuk_frontend_jinja/components/summary-list/macro.html" import govukSummaryList %}
{% from "govuk_frontend_jinja/components/button/macro.html" import govukButton %}
{% from "govuk_frontend_jinja/components/back-link/macro.html" import govukBackLink %}
{% extends "developers/access_grant_funding_base.html" %}

{% block pageTitle %}
  Check your answers - MHCLG Funding Service
{% endblock pageTitle %}

{% block beforeContent %}
  {{
    govukBackLink({
        "text": "Back",
        "href": back_link,
    })
  }}
{% endblock beforeContent %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-l">{{ form.name }}</span>
      <h1 class="govuk-heading-l">Check your answers</h1>

      {% set rows = [] %}
      {% for question in collection_helper.get_ordered_visible_questions_for_form(form) %}
        {% set answer = collection_helper.get_answer_for_question(question.id) %}
        {% if answer is not none %}
          {%
            do rows.append({
              "key": {"text": question.text},
              "value": {"text": answer.root},
              "actions": {"items": [{"href": url_for('developers.ask_a_question', collection_id=collection_helper.collection.id, question_id=question.id, source=back_link_source_enum.CHECK_YOUR_ANSWERS.value), "text": "Change", "visuallyHiddenText": question.name}]},
            })
          %}
        {% else %}
          {% set valueLink %}
            <a href="{{ url_for('developers.ask_a_question', collection_id=collection_helper.collection.id, question_id=question.id, source=back_link_source_enum.CHECK_YOUR_ANSWERS.value) }}" class="govuk-link govuk-link--no-visited-state">
              Enter {{ question.name }}
            </a>
          {% endset %}
          {%
            do rows.append({
              "key": {"text": question.text},
              "value": {"html": valueLink}
            })
          %}
        {% endif %}
      {% endfor %}

      {{
        govukSummaryList({
          "classes": "govuk-!-margin-bottom-9",
          "rows": rows
        })
      }}

      {{
        govukButton({
          "text": "Save and continue",
          "href": url_for("developers.collection_tasklist", collection_id=collection_helper.collection.id)
        })
      }}
    </div>
  </div>
{% endblock content %}
