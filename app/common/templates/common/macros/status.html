{% from "govuk_frontend_jinja/components/tag/macro.html" import govukTag %}

{% macro status(status) %}
  {%
    set classMap = {
        enum.tasklist_section_status.NOT_STARTED: "govuk-tag--grey",
        enum.tasklist_section_status.IN_PROGRESS: "govuk-tag--blue",
        enum.tasklist_section_status.COMPLETED: "govuk-tag--green",
        enum.tasklist_section_status.NO_QUESTIONS: "govuk-tag--red",
    }
  %}
  {{ govukTag({"text": status, "classes": classMap[status] }) }}
{% endmacro %}

{% macro grantStatusTag(status) %}
  {%
    set classMap = {
        enum.grant_status.DRAFT: "govuk-tag--yellow",
        enum.grant_status.ONBOARDING: "govuk-tag--yellow",
        enum.grant_status.LIVE: "govuk-tag--green",
    }
  %}
  {{ govukTag({"text": status | title, "classes": classMap[status] }) }}
{% endmacro %}

{% macro grantStatusDescription(grant) %}
  {% if grant.status == enum.grant_status.DRAFT %}
    Reports cannot be published until the grant is live.
  {% elif grant.status == enum.grant_status.LIVE and grant.reports | selectattr('status', 'equalto', enum.collection_status.OPEN) | list | length == 0 %}
    There are no reports live.
  {% endif %}
{% endmacro %}

{% macro reportStatusTag(status) %}
  {%
    set classMap = {
        enum.collection_status.DRAFT: "govuk-tag--yellow",
        enum.collection_status.SCHEDULED: "govuk-tag--blue",
        enum.collection_status.OPEN: "govuk-tag--green",
        enum.collection_status.CLOSED: "govuk-tag--grey",
    }
  %}
  {{ govukTag({"text": status, "classes": classMap[status] }) }}
{% endmacro %}

{% macro submissionStatusTag(status, overdue=False) %}
  {%
    set classMap = {
        enum.submission_status.NOT_STARTED: "govuk-tag--grey" if not overdue else "govuk-tag--yellow",
        enum.submission_status.IN_PROGRESS: "govuk-tag--light-blue" if not overdue else "govuk-tag--yellow",
        enum.submission_status.COMPLETED: "",
        enum.submission_status.READY_TO_SUBMIT: "govuk-tag--blue" if not overdue else "govuk-tag--yellow",
        enum.submission_status.AWAITING_SIGN_OFF: "govuk-tag--purple",
    }
  %}
  {{ govukTag({"text": status if not overdue else "Overdue", "classes": classMap[status] }) }}
{% endmacro %}

{% macro submissionStatusAction(status) %}
  {%
    set textMap = {
        enum.submission_status.NOT_STARTED: "Start report",
        enum.submission_status.IN_PROGRESS: "Continue report",
        enum.submission_status.COMPLETED: "View report",
        enum.submission_status.READY_TO_SUBMIT: "View report",
        enum.submission_status.AWAITING_SIGN_OFF: "View report",
    }
  %}
  {{ textMap[status] }}
{% endmacro %}
