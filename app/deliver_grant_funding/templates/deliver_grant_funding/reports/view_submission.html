{% from "deliver_grant_funding/macros/deliver_grant_funding_reports_breadcrumb.html" import deliver_grant_funding_reports_breadcrumb %}
{% from "common/partials/mhclg-test-banner.html" import mhclgTestBanner %}
{% from "common/macros/status.html" import submissionStatusTag with context %}
{% from "common/macros/submissions.html" import answers_summary_list with context %}
{% extends "deliver_grant_funding/grant_base.html" %}

{% set page_title = "Submission - " ~ helper.submission.collection.name %}
{% set active_item_identifier = "reports" %}

{% block beforeContent %}
  {% if helper.is_test %}
    {{ mhclgTestBanner("Test submission", false) }}
  {% endif %}

  {{ deliver_grant_funding_reports_breadcrumb(grant=grant, immediate_parent_breadcrumb_item={"text": "Submissions", "href": url_for("deliver_grant_funding.list_submissions", grant_id=grant.id, report_id=helper.submission.collection.id, submission_mode=helper.submission.mode)}, this_page_breadcrumb_item={"text": helper.submission.grant_recipient.organisation.name if helper.submission.grant_recipient else helper.submission.created_by.email }) }}
{% endblock beforeContent %}

{% block content %}
  <span class="govuk-caption-l">{{ helper.submission.grant_recipient.organisation.name if helper.submission.grant_recipient else helper.submission.created_by.email }}</span>
  <div class="app-aligned-header-tag govuk-!-margin-bottom-6">
    <h1 class="govuk-heading-l govuk-!-margin-bottom-0">Submission</h1>
    {{ submissionStatusTag(helper.status) }}
  </div>

  {% for form in helper.get_ordered_visible_forms() %}
    <h2 class="govuk-heading-m govuk-!-margin-top-4">{{ form.title }}</h2>
    {{ answers_summary_list(helper, form) }}
  {% endfor %}

  <p class="govuk-body">
    <a class="govuk-link govuk-link--no-visited-state" href="{{ url_for('deliver_grant_funding.list_submissions', grant_id=grant.id, report_id=helper.submission.collection.id, submission_mode=helper.submission.mode) }}">
      Back to submissions
    </a>
  </p>
{% endblock content %}
