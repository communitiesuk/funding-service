{% from "common/macros/collections.html" import collection_add_another_summary with context %}
{% from "common/macros/collections.html" import collection_question with context %}
{% from "common/macros/collections.html" import collection_before with context %}
{% extends "developers/deliver/access_grant_funding_base.html" %}

{% set is_add_another_summary = runner.component.add_another_container and runner.add_another_index == None %}

{# set the page title #}
{% set page_title = runner.interpolate(runner.component.text if not is_add_another_summary else runner.component.add_another_container.text) ~ " - " ~ runner.form.title %}

{# configure the page for the base error summary #}
{# todo: probably worth just aliasing this in the render call #}
{% set form = runner.question_form if not is_add_another_summary else runner.add_another_summary_form %}

{% block beforeContent %}
  {{ collection_before(runner, override_back_link=None if not is_first_question_in_task_preview else url_for("deliver_grant_funding.list_task_questions", grant_id=runner.submission.grant.id, form_id=runner.form.id)) }}
{% endblock beforeContent %}

{% block content %}
  <div class="govuk-grid-row">
    {# todo: should this happen here or be decided the macro itself #}
    {#       gut feeling on this is that the macro should handle it and be renamed to reflect it will do both appropriately #}
    {% if is_add_another_summary %}
      <div class="govuk-grid-column-two-thirds">{{ collection_add_another_summary(runner) }}</div>
    {% else %}
      <div class="govuk-grid-column-two-thirds">{{ collection_question(runner) }}</div>
    {% endif %}
  </div>
{% endblock content %}
